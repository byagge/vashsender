<!DOCTYPE html>
<html lang="en" x-data="emailTemplateApp()" x-init="init()">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Email Template App</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Alpine.js -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <!-- Lucide Icons -->
  <script type="module" src="https://unpkg.com/lucide@0.264.0/dist/lucide.esm.js"></script>
  <script nomodule src="https://unpkg.com/lucide@0.264.0/dist/lucide.iife.js"></script>
</head>
<body class="flex h-screen bg-gradient-to-br from-slate-50 to-blue-50 font-sans overflow-hidden">
  <!-- Sidebar -->
  <div class="w-80 bg-gradient-to-b from-slate-50 to-white border-r border-gray-200 h-screen flex flex-col relative overflow-hidden">
    <!-- decoration -->
    <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-100 to-purple-100 rounded-full -translate-y-16 translate-x-16 opacity-50"></div>
    <div class="relative z-10 p-8 border-b border-gray-100">
      <div class="flex items-center space-x-3 mb-2">
        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg">
          <i data-lucide="mail" class="w-6 h-6 text-white"></i>
        </div>
        <div>
          <h1 class="text-2xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent">EmailCraft</h1>
          <p class="text-sm text-gray-500">Beautiful emails, effortlessly</p>
        </div>
      </div>
    </div>
    <nav class="flex-1 p-6 space-y-3">
      <button @click="view='templates'" :class="view==='templates'?activeBtn:'btn'" class="w-full group flex items-center space-x-4 px-6 py-4 rounded-2xl transition-all duration-300">
        <i data-lucide="mail" class="w-6 h-6 transition-transform group-hover:scale-110"></i>
        <span class="font-semibold">Templates</span>
        <template x-if="view==='templates'"><div class="ml-auto w-2 h-2 bg-white rounded-full animate-pulse"></div></template>
      </button>
      <button @click="createNew()" class="w-full group flex items-center space-x-4 px-6 py-4 rounded-2xl text-gray-600 hover:bg-gradient-to-r hover:from-emerald-50 hover:to-teal-50 hover:text-emerald-700 transition-all duration-300 hover:shadow-md">
        <div class="w-6 h-6 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-lg flex items-center justify-center">
          <i data-lucide="plus" class="w-4 h-4 text-white"></i>
        </div>
        <span class="font-semibold">Create New</span>
      </button>
      <button class="w-full group flex items-center space-x-4 px-6 py-4 rounded-2xl text-gray-600 hover:bg-white hover:shadow-md hover:text-gray-800 transition-all duration-300">
        <i data-lucide="settings" class="w-6 h-6 transition-transform group-hover:rotate-180 duration-500"></i>
        <span class="font-semibold">Settings</span>
      </button>
    </nav>
    <div class="p-6 border-t border-gray-100">
      <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-2xl border border-purple-100">
        <p class="text-sm text-purple-700 font-medium">ðŸ’¡ Pro Tip</p>
        <p class="text-xs text-purple-600 mt-1">Use our visual editor for quick formatting, then switch to HTML for fine-tuning!</p>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex-1 overflow-hidden relative">
    <!-- Templates View -->
    <div x-show="view==='templates'" class="p-8 bg-gradient-to-br from-gray-50 to-white min-h-screen">
      <!-- Header -->
      <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center mb-10">
        <div class="mb-6 lg:mb-0">
          <h2 class="text-4xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-2">Email Templates</h2>
          <p class="text-gray-600 text-lg">Create, edit, and manage your beautiful email templates</p>
        </div>
        <button @click="createNew()" class="group flex items-center space-x-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-4 rounded-2xl transition-all duration-300 shadow-lg hover:scale-105">
          <i data-lucide="plus" class="w-6 h-6 group-hover:rotate-180 transition-transform duration-300"></i>
          <span class="font-semibold text-lg">Create New Template</span>
        </button>
      </div>
      <!-- Search & Filter -->
      <div class="flex flex-col sm:flex-row gap-4 mb-8">
        <div class="relative flex-1">
          <i data-lucide="search" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"></i>
          <input type="text" placeholder="Search templates..." x-model="search" class="w-full pl-12 pr-4 py-4 bg-white border border-gray-200 rounded-2xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-300" />
        </div>
        <div class="relative">
          <i data-lucide="filter" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"></i>
          <select x-model="category" class="pl-12 pr-8 py-4 bg-white border border-gray-200 rounded-2xl focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-300 cursor-pointer">
            <template x-for="cat in ['all',...uniqueCategories]" :key="cat">
              <option :value="cat" x-text="cat==='all'?'All Categories':cat"></option>
            </template>
          </select>
        </div>
      </div>
      <!-- List -->
      <template x-if="loading">
        <div class="flex flex-col items-center justify-center py-20">
          <div class="relative">
            <div class="w-16 h-16 border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin"></div>
            <div class="absolute inset-0 w-16 h-16 border-4 border-transparent border-r-purple-500 rounded-full animate-spin animation-delay-75"></div>
          </div>
          <p class="mt-6 text-gray-600 font-medium">Loading your beautiful templates...</p>
        </div>
      </template>
      <div class="grid gap-8 md:grid-cols-2 xl:grid-cols-3" x-show="!loading">
        <template x-for="(tpl,index) in filteredTemplates" :key="tpl.id">
        <div @click="editTemplate(tpl)" class="group bg-white border border-gray-200 rounded-3xl overflow-hidden hover:shadow-2xl cursor-pointer transition-all duration-500 hover:scale-105" :style="{'animation-delay': index*100+'ms'}">
          <div class="relative h-48 bg-gradient-to-br from-gray-50 to-gray-100 overflow-hidden">
            <div x-html="tpl.content" class="absolute inset-0 scale-50 origin-top-left transform group-hover:scale-55 transition-transform duration-300"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-white/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            <div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
              <div class="flex space-x-2">
                <button class="p-2 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-colors"><i data-lucide="copy" class="w-4 h-4"></i></button>
                <button class="p-2 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-colors"><i data-lucide="more-vertical" class="w-4 h-4"></i></button>
              </div>
            </div>
          </div>
          <div class="p-6">
            <div class="flex items-start justify-between mb-3">
              <h3 class="text-xl font-bold text-gray-800 group-hover:text-blue-600 transition-colors duration-300" x-text="tpl.name"></h3>
              <span class="px-3 py-1 bg-gradient-to-r from-blue-100 to-purple-100 text-blue-700 text-xs font-semibold rounded-full" x-text="tpl.category"></span>
            </div>
            <p class="text-gray-600 text-sm mb-4 line-clamp-2 leading-relaxed" x-text="truncate(tpl.content,120)"></p>
            <div class="flex items-center justify-between text-xs text-gray-500">
              <span x-text="'Modified: '+formatDate(tpl.lastModified)"></span>
              <div class="flex items-center space-x-1">
                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                <span>Ready</span>
              </div>
            </div>
          </div>
        </div>
        </template>
      </div>
      <template x-if="!loading && filteredTemplates.length===0">
        <div class="text-center py-20">
          <div class="w-24 h-24 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full flex items-center justify-center mx-auto mb-6">
            <i data-lucide="search" class="w-12 h-12 text-gray-400"></i>
          </div>
          <h3 class="text-2xl font-bold text-gray-600 mb-2">No templates found</h3>
          <p class="text-gray-500 mb-8">Try adjusting your search or create a new template</p>
          <button @click="createNew()" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-xl hover:scale-105 transition-all duration-300 shadow-lg">Create Your First Template</button>
        </div>
      </template>
    </div>

    <!-- Editor View -->
    <div x-show="view==='editor'" class="h-screen flex flex-col bg-gradient-to-br from-gray-50 to-white">
      <!-- Editor Header -->
      <div class="bg-white/80 backdrop-blur-md border-b border-gray-200 p-6 shadow-sm">
        <div class="max-w-7xl mx-auto flex items-center justify-between mb-6">
          <button @click="view='templates'" class="group flex items-center space-x-3 text-gray-600 hover:text-gray-800 transition px-4 py-2 rounded-xl">
            <i data-lucide="arrow-left" class="w-5 h-5 group-hover:-translate-x-1 transition-transform duration-300"></i>
            <span class="font-semibold">Back to Templates</span>
          </button>
          <div class="flex items-center space-x-6">
            <div x-show="saveStatus==='saving'" class="flex items-center space-x-2 text-blue-600"><div class="w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"></div><span class="font-medium">Saving...</span></div>
            <div x-show="saveStatus==='saved'" class="flex items-center space-x-2 text-emerald-600"><div class="w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center"><i data-lucide="check" class="w-4 h-4"></i></div><span class="font-medium">All changes saved</span></div>
            <div x-show="saveStatus==='error'" class="flex items-center space-x-2 text-red-600"><i data-lucide="alert-circle" class="w-4 h-4"></i><span class="font-medium">Save failed</span></div>
            <button @click="save()" class="group flex items-center space-x-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-xl transition-all duration-300 hover:scale-105 shadow-lg">
              <i data-lucide="save" class="w-5 h-5 group-hover:scale-110 transition-transform duration-300"></i>
              <span class="font-semibold">Save Template</span>
            </button>
          </div>
        </div>
        <input type="text" x-model="current.name" @input="onChange('name',$event.target.value)" placeholder="Enter template name..." class="w-full text-3xl font-bold border-none outline-none focus:ring-0 p-0 bg-transparent text-gray-800" />
      </div>
      <div class="flex-1 flex max-w-7xl mx-auto w-full">
        <!-- Editor Pane -->
        <div class="flex-1 flex flex-col mr-6">
          <div class="bg-white/50 backdrop-blur-sm border-b border-gray-200 p-4 flex space-x-2">
            <button @click="editMode='visual'" :class="editMode==='visual'?tabActive:'tab'" class="flex items-center space-x-2 px-6 py-3 rounded-xl transition-all duration-300"><i data-lucide="eye" class="w-5 h-5"></i><span class="font-semibold">Visual Editor</span></button>
            <button @click="editMode='html'" :class="editMode==='html'?tabActiveHtml:'tab'" class="flex items-center space-x-2 px-6 py-3 rounded-xl transition-all duration-300"><i data-lucide="edit" class="w-5 h-5"></i><span class="font-semibold">HTML Editor</span></button>
          </div>
          <div class="flex-1 p-6">
            <template x-if="editMode==='html'"><textarea x-model="current.content" @input="onChange('content',$event.target.value)" class="w-full h-full border-2 border-gray-200 rounded-2xl p-6 font-mono text-sm resize-none focus:ring-4 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all duration-300 shadow-sm" placeholder="Enter your HTML content here..."></textarea></template>
            <template x-if="editMode==='visual'"><div contenteditable x-ref="editor" @input="onVisualInput" class="border border-gray-200 rounded-2xl overflow-hidden shadow-sm bg-white prose prose-sm max-w-none p-6 min-h-80 max-h-96 overflow-y-auto focus:outline-none" style="font-family: 'Inter, system-ui, sans-serif';"></div></template>
          </div>
        </div>
        <!-- Preview Pane -->
        <div class="w-1/2 border-l border-gray-200 bg-gradient-to-br from-gray-50 to-white">
          <div class="bg-white/80 backdrop-blur-sm border-b border-gray-200 p-6 flex items-center space-x-3">
            <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center"><i data-lucide="eye" class="w-4 h-4 text-white"></i></div>
            <h3 class="text-xl font-bold text-gray-800">Live Preview</h3>
          </div>
          <div class="p-6 h-full overflow-auto">
            <div class="bg-white rounded-2xl shadow-xl p-8 min-h-full border border-gray-100" x-html="current.content"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function emailTemplateApp() {
      return {
        view: 'templates',
        templates: [],
        loading: true,
        error: null,
        search: '',
        category: 'all',
        current: null,
        editMode: 'visual',
        saveStatus: 'saved',
        saveTimeout: null,
        init() {
          this.load();
          lucide.replace();
        },
        mockAPI: {
          getTemplates: () => Promise.resolve([...]), // copy mock data here
          saveTemplate: tpl => new Promise(res => setTimeout(() => res({...tpl, lastModified: new Date().toISOString()}),800)),
          createTemplate: tpl => new Promise(res => setTimeout(() => res({...tpl, id: Date.now(), lastModified: new Date().toISOString()}),800))
        },
        async load() {
          try { this.loading = true;
            await new Promise(r=>setTimeout(r,1000));
            this.templates = await this.mockAPI.getTemplates();
          } catch(e){ this.error='Load failed'; }
          finally{ this.loading=false; }
        },
        get uniqueCategories() { return [...new Set(this.templates.map(t=>t.category))]; },
        get filteredTemplates() {
          return this.templates.filter(t=>{
            const mSearch = t.name.toLowerCase().includes(this.search.toLowerCase())||t.content.toLowerCase().includes(this.search.toLowerCase());
            const mCat = this.category==='all'||t.category===this.category;
            return mSearch&&mCat;
          });
        },
        formatDate(dt){return new Date(dt).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'});},
        truncate(html,len){const txt=html.replace(/<[^>]*>/g,'');return txt.length>len?txt.slice(0,len)+'...':txt;},
        createNew(){ this.current = {id:null,name:'Untitled Template',content:'<div style="padding:40px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:16px;text-align:center;color:white;"><h1 style="margin:0 0 20px 0;font-size:32px;">âœ¨ Start Creating</h1><p style="font-size:18px;opacity:0.9;margin:0;">Begin crafting your beautiful email template here...</p></div>',lastModified:new Date().toISOString(),category:'Custom'}; this.view='editor'; this.$nextTick(()=>{this.$refs.editor.innerHTML=this.current.content}); },
        editTemplate(tpl){ this.current=JSON.parse(JSON.stringify(tpl)); this.view='editor'; this.$nextTick(()=>{ if(this.editMode==='visual') this.$refs.editor.innerHTML=this.current.content}); },
        onChange(field,val){ this.current[field]=val; this.autoSave(); },
        onVisualInput(){ this.current.content=this.$refs.editor.innerHTML; this.autoSave(); },
        autoSave(){ this.saveStatus='saving'; clearTimeout(this.saveTimeout); this.saveTimeout=setTimeout(()=>this.save(),1200); },
        async save(){ if(!this.current) return; clearTimeout(this.saveTimeout); this.saveStatus='saving'; try{ let saved;
            if(this.current.id){ saved=await this.mockAPI.saveTemplate(this.current);
              this.templates=this.templates.map(t=>t.id===saved.id?saved:t);
            } else { saved=await this.mockAPI.createTemplate(this.current);
              this.templates.push(saved); this.current=saved;
            }
            this.saveStatus='saved';
          }catch(e){ this.saveStatus='error'; this.error='Save failed'; }
        },
        get tab(){ return 'text-gray-600 hover:text-gray-800 hover:bg-white/80'; },
        get tabActive(){ return 'bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg'; },
        get tabActiveHtml(){ return 'bg-gradient-to-r from-emerald-500 to-teal-600 text-white shadow-lg'; },
        get activeBtn(){ return 'bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg'; }
      }
    }
  </script>
</body>
</html>
